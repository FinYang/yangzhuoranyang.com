


<p>+++
title = “Hideous cheatsheet”</p>
<p>date = 2019-05-01
# lastmod = 2018-09-09T00:00:00</p>
<div id="list-format." class="section level1">
<h1>List format.</h1>
</div>
<div id="simple" class="section level1">
<h1>0 = Simple</h1>
</div>
<div id="detailed" class="section level1">
<h1>1 = Detailed</h1>
</div>
<div id="stream" class="section level1">
<h1>2 = Stream</h1>
<p>list_format = 2</p>
</div>
<div id="optional-featured-image-relative-to-staticimg-folder." class="section level1">
<h1>Optional featured image (relative to <code>static/img/</code> folder).</h1>
<p>[header]
image = ""
caption = ""
+++</p>
<p>```r</p>
<p>start &lt;- as.Date(“2018-08-14”)
paste(“I have started my timetable for”, (Sys.Date() - start + 1), “days.”)
time1 &lt;- Sys.time()
time2 &lt;- Sys.time()
time2 - time1</p>
</div>
<div id="names-and-values" class="section level1">
<h1>Names and Values ——————————————————–</h1>
<p>library(lobstr)
obj_addr(mean)
obj_addr(base::mean)
obj_addr(get(“mean”))
obj_addr(evalq(mean))
obj_addr(match.fun(“mean”))</p>
</div>
<div id="r" class="section level1">
<h1>R ———————————————————————–</h1>
<p>a = 132
b &lt;- 321
231 -&gt;c
?abs # return absolute value
??absolute</p>
</div>
<div id="atomic-classes" class="section level1">
<h1>5 atomic classes</h1>
<p>class(a)
# 3 number types
# numeric (default) double 8 bytes
Inf
# integer 4 bytes (prefered when data are large)
a &lt;- 132L
# complex
c &lt;- 2 + 3i
# 1 character type
# 1 logical type
TRUE
T
FALSE
F
typeof(a)
# logical opeartors
# AND
&amp;
# OR
|
# NOT
!</p>
</div>
<div id="vector" class="section level1">
<h1>vector</h1>
<p>1:10
seq_len(10)
vec &lt;- vector(length = 5)
length(vec)
vec &lt;- c(b,c,d)
vec[1]
vec[1:2]
vec[c(1,3)]
names(vec)
names(vec) &lt;- c("“,”")</p>
<p>subset()
order()
a[order(a)] # ascending or decending order
sort()</p>
</div>
<div id="factor-out-of-vector" class="section level1">
<h1>factor (out of vector)</h1>
<p>fac &lt;- as.factor(f)
# A character vector that also stores every unique value in the vector,
# and use these unique values and indexs them and fills them in
levels(fac) # return those unique values
levels(fac) &lt;- c("“,”“,”") # reasign new levels</p>
<p>fac[1:2]
fac[fac == “New York”]</p>
</div>
<div id="nominal-categorical-variable-no-order" class="section level1">
<h1>nominal categorical variable, no order</h1>
</div>
<div id="ordinal-categorical-variable-natural-ordering" class="section level1">
<h1>ordinal categorical variable, natural ordering</h1>
<p>factor_temporature_vector &lt;- factor(temperature_vector, order = TRUE,
levels = c(“Low”, “Medium”, “High”))</p>
</div>
<div id="matrix" class="section level1">
<h1>Matrix</h1>
<p>vac.a &lt;- c(1, 2, 3, 4)
vac.b &lt;- c(8, 19, 15, 17)
mat.c &lt;- cbind(vac.a, vac.b) # as column
mat.r &lt;- rbind(vec.a, vec.b) # as row
rowSums()
colSums()
mat.r[1,2]
dim(mat.c)
dim(mat.c) &lt;- c(2,4)</p>
<p>mat.c[, 1]
mat.c[1, ]
mat.c[, “vec.a”]
mat.c[, c(“vec.a”, “vec.c”)]
dimnames(mat.c) # must be a list
colnames(mat.c)
rownames(mat.c)
colnames(mat.c) &lt;- c(“alpha”, “beta”, “gamma”)
nrow(mat.c)
ncol(mat.c)</p>
</div>
<div id="data-frame" class="section level1">
<h1>Data frame</h1>
<p>data(iris)
head(iris)
tail(iris)
data.frame()
str()
iris<span class="math inline">\(Species iris[iris\)</span>Sepal.Length &gt; 6.5, ]
iris[iris$Sepal.Length &gt; 6.5, c(“Sepal.Width”, “Species”)]</p>
</div>
<div id="list" class="section level1">
<h1>List</h1>
<p>list.a &lt;- list(1, “a”, TRUE, 2+5i)
list[5] # return 5th element as a list
list[[5]] # return 5th element as its original class
list.b &lt;- list(a = c(T, T, F, F), b = 2, c = “Hello”)
list.b$a
list.b[[“a”]]
names(my.list) &lt;- c(“name1”, “name2”)
ext_list &lt;- c(ext_list, new_name = new_val)
# list to dataframe
do.call(rbind, list)
# dataframe to list
setNames(split(month.name, 1:12), month.abb)</p>
<p>as.factor()
as.integer(23.4)
as.numeric(2+3i)
as.complex(2)
as.character(34)</p>
<p>class(34) == “integer”
is.integer(34)
is.integer(34L)</p>
</div>
<div id="install" class="section level1">
<h1>Install</h1>
<p>install.packages(“plyr”)
library(plyr)
attach()
# working directory
getwd()
setwd(“./bootcamp”) # in additional on the orginal one
dir() # list the files in current directory
source("") # run previously written script after properly setting directory
# Global options
options()
par().</p>
</div>
<div id="remove-all-objects" class="section level1">
<h1>remove all objects</h1>
<p>rm(list=ls())</p>
<p>View()
ls()
show()</p>
</div>
<div id="modulo" class="section level1">
<h1>modulo</h1>
<p>5 %% 2
# The modulo returns the reminder of the division of the number to the left
# by the number on its right</p>
</div>
<div id="random-number" class="section level1">
<h1>random number</h1>
<p>runif()
rnorm()</p>
</div>
<div id="loops" class="section level1">
<h1>loops</h1>
<p>for(var in seq){
expr
next #skip to next iteration
}</p>
</div>
<div id="progress-bar" class="section level1">
<h1>progress bar</h1>
<p>pb &lt;- txtProgressBar(min = 0, max = total, style = 3)
for(i in 1:total){
Sys.sleep(0.1)
# update progress bar
setTxtProgressBar(pb, i)
}
close(pb)
ctr &lt;- 1
while(ctr &lt;= 7){
if(ctr %% 5 ==0){
break # abandon the active loop
}
print(paste(“cte is set to”, ctr))
ctr &lt;- ctr + 1
}</p>
</div>
<div id="stack-matrix" class="section level1">
<h1>stack matrix</h1>
<p>t(replicate(2,1:5))</p>
</div>
<div id="symmetric-matrixg" class="section level1">
<h1>symmetric matrixg</h1>
<p>s.diag = diag(s)
s[lower.tri(s,diag=T)] = 0
s = s + t(s) + diag(s.diag,S)</p>
</div>
<div id="spelling-check--" class="section level1">
<h1>spelling check ———————————————————-</h1>
<p>spelling::spell_check_package(getwd())
#or
F7</p>
</div>
<div id="function--" class="section level1">
<h1>function —————————————————————-</h1>
<p>function_name &lt;- function(args){
do_stuff
}</p>
<p>args() #check arguments without checking documentation</p>
<p>print()
str()
summary()
sqrt()
mean()
median()
sum()
round() # number of digits</p>
<p>append() # vector merging
rec() # Reverse Elements</p>
</div>
<div id="knitr--" class="section level1">
<h1>knitr ——————————————————————-</h1>
<p>read_chunk(“lab04.R”)
list.files(getwd())
knitr::purl(“LP_simulation.Rmd”)</p>
</div>
<div id="tidyr-verbs" class="section level1">
<h1>tidyr verbs ————————————————————–</h1>
<p>library(tidyr)
# Gather: specify the keys (identifiers) and the values (measures) to make long form (“melting”)
# key: name of the column of variables
# value: name of the column of values
# V1:V3 columns that need to be gathered
gather(data, key = variable, value = rating, V1:V3)</p>
</div>
<div id="spread-long-to-wide-variables-in-columns-casting" class="section level1">
<h1>Spread: long to wide, variables in columns (“casting”)</h1>
<p>spread(data, key = variable, value = rating)</p>
</div>
<div id="nestunnest-working-with-lists" class="section level1">
<h1>nest/unnest: working with lists</h1>
</div>
<div id="separateunite-split-and-combine-columns" class="section level1">
<h1>separate/unite: split and combine columns</h1>
</div>
<div id="split-apply-combine-approach" class="section level1">
<h1>Split-apply-combine approach</h1>
</div>
<div id="split-a-dataset-into-many-smaller-sub-datasets" class="section level1">
<h1>1. Split a dataset into many smaller sub-datasets</h1>
</div>
<div id="apply-some-function-to-each-sub-dataset-to-compute-a-result" class="section level1">
<h1>2. Apply some function to each sub-dataset to compute a result</h1>
</div>
<div id="combine-the-results-of-the-function-calls-into-one-dataset" class="section level1">
<h1>3. Combine the results of the function calls into one dataset</h1>
<p>ff_summary &lt;- ff_long %&gt;% group_by(variable) %&gt;% # SPLIT
summarise(
m = mean(rating, na.rm = TRUE),
s = sd(rating, na.rm = TRUE)
) # APPLY + COMBINE</p>
</div>
<div id="dplyr-verbs--" class="section level1">
<h1>dplyr verbs ————————————————————-</h1>
</div>
<div id="filter-remove-the-rows-of-a-date-frame-producing-subsets-on-obvervation" class="section level1">
<h1>Filter: Remove the rows of a date frame, producing subsets (on obvervation)</h1>
<p>data %&gt;% filter(variable1 == value)
# Arrange: Reorder the rows of a data frame
data %&gt;% arrange(desc(variable))
# Select: Select particular columns of a data frame (on variables)
data %&gt;% select(var1, var2, var3)
# Mutate: Add new columns that are functions of existing columns
data %&gt;% mutate(varname = )
# Summarise: Create collapsed summaries of a data frame
data %&gt;% group_by(var1, var2) %&gt;% summarise(mean_var3 = mean(var3), sd_var3 = sd(var3))
# Rename: Rename variables in a data frame
rename()
# group_by: takes and existing tbl and converts it into a grouped tbl
group_by()</p>
</div>
<div id="tibble" class="section level1">
<h1>tibble ——————————————————————</h1>
<p>library(tibble)
vignette(“tibble”)
add_row(df, x=4, y=0, .before = 2)
add_column(z = -1:1, .after = “x”)</p>
<p>yawn_expt &lt;- tibble(group = c(rep(“control”, 16),
rep(“treatment”, 34)),
yawn = c(rep(“no”, 12), rep(“yes”, 4),
rep(“no”, 24), rep(“yes”, 10)))
yawn_expt %&gt;%
group_by(group, yawn) %&gt;%
tally() %&gt;% #count the number of wach group
ungroup() %&gt;%
spread(yawn, n) %&gt;%
mutate(total = rowSums(.[-1]))</p>
</div>
<div id="plot-ggplot2" class="section level1">
<h1>Plot, ggplot2 —————————————————————–</h1>
</div>
<div id="plot" class="section level1">
<h1>plot</h1>
<p>plot(x,y)
hist(x)
boxplot(x)
par(mfrow = c(1,2))
plot(iris<span class="math inline">\(Petal.Width, iris\)</span>Petal.Length, main = "") # naming the plot
library(lattice)
histogram(iris$Petal.Width)</p>
<p>curve</p>
</div>
<div id="ggplot2" class="section level1">
<h1>ggplot2</h1>
<p>library(ggplot2)
ggplot(data = economics, aes(x = pce)) +
geom_histogram(binwidth = 500, colour = “blue”, fill =“lightblue”)+
geom_vline(xintercept = 10000 , colour = “red”)</p>
<p>#density curves for Weibull
xgrid &lt;- seq(0, 5, 0.05)
df &lt;- data.frame(
x = xgrid,
d1 = dweibull(xgrid, shape = 3, scale = 1.5),
d2 = dweibull(xgrid, shape = 2, scale = 2),
d3 = dweibull(xgrid, shape = 1, scale = 1)
)
df &lt;- df %&gt;%
gather(dist, density, d1:d3) %&gt;%
mutate(dist = factor(
dist, levels = c(“d1”, “d2”, “d3”),
labels = c(“Weibull(3, 1.5)”, “Weibull(2, 2)”, “Weibull(1, 1)”)
))
ggplot(df, aes(x=x, y=density, colour = dist)) +
geom_line()</p>
<p>#theme
savep50 &lt;- function(pdata, i){
ggplot(as.data.frame(pdata), aes(x = yhat, y=res, alpha = 0.05)) +
geom_point() +
xlim(c(-4, 4)) +
ylim(c(-4, 4)) +
theme(axis.line=element_blank(),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position=“none”,
panel.background=element_blank(),
panel.border=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank())
ggsave(filename = paste(“p50_”, i, “.png”, sep = ""), height = 4, width = 4, dpi = 500)</p>
<p>}</p>
<p>mapply(savep50, train50, c(1:1000))</p>
</div>
<div id="qq-plot" class="section level1">
<h1>QQ-plot</h1>
<p>set.seed(123)
n &lt;- 500
alpha &lt;- 4
beta &lt;- 2
df_gamma &lt;- data.frame(
xgamma = rgamma(n, shape = alpha, rate = beta)
)
df_gamma$xq &lt;- qgamma(
c(1 - 0.5^(1/n), # i = 1
(2:(n-1) - 0.3175) / (n + 0.365), # i = 2, … , n - 1
0.5^(1/n)), # i = n
alpha, beta
) # theoretical quantiles
ggplot(data = df_gamma, aes(x = sort(xgamma), y = xq)) +
geom_point() +
geom_abline(intercept = 0, slope = 1) + # X = Y line
xlab(“Sample quantiles”) +
ylab(“Theoretical quantiles”) +
coord_equal()</p>
</div>
<div id="likelihood-plotly-3d-plot" class="section level1">
<h1>likelihood, plotly, 3D plot ———————————————</h1>
</div>
<div id="likelihood" class="section level1">
<h1>likelihood</h1>
<p>set.seed(123)
X2 &lt;- data.frame(x = rgamma(n = 544, 3.2, 1.7))
ggplot(X2, aes(x = x)) +
geom_histogram(bindwidth = 0.3)
nmle &lt;- function(x, alpha, beta){
likelihood &lt;- prod(dgamma(x, alpha, beta))
return(likelihood)
}
alpha &lt;- seq(2.7, 3.8, 0.01)
beta &lt;- seq(1.45, 2.2, 0.01)
# all possible combinations of alpha and beta
g &lt;- expand.grid(x = alpha, y = beta)
g<span class="math inline">\(l &lt;- 0 for(i in 1:nrow(g)){  g\)</span>l[i] &lt;- nmle(X2<span class="math inline">\(x, g\)</span>x[i], g<span class="math inline">\(y[i]) } ggplot(g, aes(x=x, y=y, fill=l)) +  geom_tile() +  scale_fill_continuous(&quot;L&quot;) +  xlab(expression(alpha)) +  ylab(expression(beta)) +  theme_bw() + # the classic dark-on-light ggplot2 theme  theme(aspect.ratio = 1) max(g\)</span>l)
g[which.max(g$l),]</p>
</div>
<div id="find-mle-using-mass-package" class="section level1">
<h1>find MLE using MASS package</h1>
<p>library(MASS)
fitdistr(X2$x, “gamma”)</p>
</div>
<div id="interactive-3d-plotly" class="section level1">
<h1>interactive 3D plotly</h1>
<p>m &lt;- matrix(g$l, nrow = length(alpha))
library(plotly)
plot_ly(x = ~ beta, y = ~ alpha, z = m) %&gt;%
add_surface()</p>
<p>snake &lt;- function(dl){
nc &lt;- ncol(dl)
mapply(function(a,b) ifelse(rep(a %% 2==0, length(b)), rev(b), b), a=1:nc, b=(apply(dl,2,list) %&gt;% unlist(recursive = F))) %&gt;% c}
dt=0.01
t &lt;- t(matrix(seq(from = 0.1, to = 1, by = dt)))
x &lt;- (matrix(seq(from = -2, to = 2, by = 0.02)))
f &lt;- dnorm(x[,rep(1, length(t))], 0,sqrt(t)[rep(1, length(x)),])
a &lt;- x[,rep(1, length(t))] %&gt;% snake
b &lt;- t[rep(1, length(x)),] %&gt;% snake
c &lt;- snake(f)
p_BM &lt;- plot_ly(data.frame(a,b,c), x = ~a, y = ~b, z = ~c, type = ‘scatter3d’, mode = ‘lines’, line = list(color = ~c,colorscale = ‘Viridis’)) %&gt;%
layout(
# title = “Layout options in a 3d scatter plot”,
scene = list(
xaxis = list(title = “Variable”),
yaxis = list(title = “Time”),
zaxis = list(title = “Probability”)
))
# plot_ly(z=~f) %&gt;% add_surface()
(p_BM)</p>
</div>
<div id="apply-family" class="section level1">
<h1>Apply family ————————————————————</h1>
<p>apply(array, margin, …)</p>
</div>
<div id="lapply" class="section level1">
<h1>lapply</h1>
<p>lapply(x, FUN, argument, …)
unlist(lapply(x, FUN, argument, …))</p>
</div>
<div id="sapply" class="section level1">
<h1>sapply</h1>
<p>sapply()
sapply(x, FUN, USA.NAMES = FALSE)</p>
<p>unique(x) # extract unique elements
identical(x, y) # test if identical</p>
</div>
<div id="vpply" class="section level1">
<h1>vpply</h1>
</div>
<div id="explicitly-specify-output-format" class="section level1">
<h1>explicitly specify output format</h1>
<p>vapply(X, FUN, FUN.VALUE = numeric(3) , …, USE.NAMES = TRUE)</p>
</div>
<div id="times-and-dates" class="section level1">
<h1>Times and Dates ———————————————————</h1>
</div>
<div id="default-y-m-d-or-ymd" class="section level1">
<h1>Default “%Y-%m-%d” or “%Y/%m/%d”</h1>
</div>
<div id="y-4-digit-year-1982" class="section level1">
<h1>%Y: 4-digit year (1982)</h1>
</div>
<div id="y-2-digit-year-82" class="section level1">
<h1>%y: 2-digit year (82)</h1>
</div>
<div id="m-2-digit-month-01" class="section level1">
<h1>%m: 2-digit month (01)</h1>
</div>
<div id="d-2-digit-day-of-the-month-13" class="section level1">
<h1>%d: 2-digit day of the month (13)</h1>
</div>
<div id="a-weekday-wednesday" class="section level1">
<h1>%A: weekday (Wednesday)</h1>
</div>
<div id="a-abbreviated-weekday-wed" class="section level1">
<h1>%a: abbreviated weekday (Wed)</h1>
</div>
<div id="b-month-january" class="section level1">
<h1>%B: month (January)</h1>
</div>
<div id="b-abbreviated-month-jan" class="section level1">
<h1>%b: abbreviated month (Jan)</h1>
<p>as.Date(“1982-01-13”)
as.Date(“Jan-13-82”, format = “%b-%d-%y”)
as.Date(“13 January, 1982”, format = “%d %B, %Y”)
format(Sys.Date(), format = “%d %B, %Y”)
format(Sys.Date(), format = “Today is a %A!”)</p>
<p>today &lt;- Sys.Date()
class(today)
my_date &lt;- as.Date(“1971-05-14”) # Default format “%Y-%m-%d” 4-2-2 digits
my_date &lt;- as.Date(“1971-14-05”, format = “%Y-%d-%m”)
my_date + 1 # days incremented by 1
my_date2 &lt;- as.Date(“1998-09-29”)
my_date2 - my_date
unclass(my_date) # 498 days from January 1, 1970</p>
<p>?strptime
# Default “%Y-%m-%d %H:%M:%S”
# %H: hours as a decimal number (00-23)
# %I: hours as a decimal number (01-12)
# %M: minutes as a decimal number
# %S: seconds as a decimal number
# %T: shorthand notation for the typical format %H:%M:%S
# %p: AM/PM indicator</p>
<p>str1 &lt;- “May 23, ’96 hours:23 minutes:01 seconds:45”
str2 &lt;- “2012-3-12 14:23:08”
time1 &lt;- as.POSIXct(str1, format = “%B %d, ’%y hours:%H minutes:%M seconds:%S”)
time2 &lt;- as.POSIXct(str2, format = “%Y-%m-%d %T”)</p>
<p>now &lt;- Sys.time()
class(now)
my_time &lt;- as.POSIXct(“1971-05-12 11:25:15”)
my_time + 1 # seconds incremented by 1
my_time2 &lt;- as.POSIXct(“1974-07-14 21:11:55 CET”)
unclass(my_time) # 43M seconds from January 1, 1970, 00:00:00</p>
</div>
<div id="lubridate" class="section level1">
<h1>lubridate</h1>
<p>library(lubridate)
now()
now(tz = “America/Chicago”)
today()
now() + hours(4)
today() - days(2)
ymd(“2013-05-14”)
mdy(“05/14/2013”)
dmy(“14052013”)
month(dmy(“14052013”))</p>
<p>floor_date()</p>
</div>
<div id="zoo" class="section level1">
<h1>zoo</h1>
<p>library(zoo)
# xts
library(xts)</p>
</div>
<div id="reading-different-file-formats-shapefiles" class="section level1">
<h1>Reading different file formats: shapefiles ——————————</h1>
</div>
<div id="the-australian-electorate-commission-publishes-the-boundaries" class="section level1">
<h1>The Australian Electorate Commission publishes the boundaries</h1>
</div>
<div id="of-the-electorates-on-their-website" class="section level1">
<h1>of the electorates on their website</h1>
</div>
<div id="at-httpwww.aec.gov.auelectoratesgisgis_datadownload.htm." class="section level1">
<h1>at <a href="http://www.aec.gov.au/Electorates/gis/gis_datadownload.htm" class="uri">http://www.aec.gov.au/Electorates/gis/gis_datadownload.htm</a>.</h1>
</div>
<div id="once-the-files-preferably-the-national-files-are-downloaded" class="section level1">
<h1>Once the files (preferably the national files) are downloaded,</h1>
</div>
<div id="unzip-the-file-it-will-build-a-folder-with-a-set-of-files." class="section level1">
<h1>unzip the file (it will build a folder with a set of files).</h1>
</div>
<div id="we-want-to-read-the-shapes-contained-in-the-shp-file-into-r." class="section level1">
<h1>We want to read the shapes contained in the shp file into R.</h1>
<p>library(maptools)</p>
</div>
<div id="shapefile-contains-the-path-to-the-shp-file" class="section level1">
<h1>shapeFile contains the path to the shp file:</h1>
<p>shapeFile &lt;- “../data/vic-esri-24122010/vic 24122010.shp”
sF &lt;- readShapeSpatial(shapeFile)
class(sF)
#&gt; [1] “SpatialPolygonsDataFrame”
#&gt; attr(,“package”)
#&gt; [1] “sp”</p>
</div>
<div id="sf-is-a-spatial-data-frame-containing-all-of-the-polygons." class="section level1">
<h1>sF is a spatial data frame containing all of the polygons.</h1>
</div>
<div id="we-use-the-rmapshaper-package-available-from-ateuchers-github-page" class="section level1">
<h1>We use the rmapshaper package available from ateucher’s github page</h1>
</div>
<div id="to-thin-the-polygons-while-preserving-the-geography" class="section level1">
<h1>to thin the polygons while preserving the geography:</h1>
<p>library(rmapshaper)
sFsmall &lt;- ms_simplify(sF, keep=0.05) # use instead of thinnedSpatialPoly
# keep indicates the percentage of points we want to keep in the polygons.
# 5% makes the electorate boundary still quite recognizable,
# but reduce the overall size of the map considerably, making it faster to plot.
plot(sFsmall)</p>
</div>
<div id="extracting-the-electorate-information" class="section level1">
<h1>Extracting the electorate information</h1>
</div>
<div id="a-spatial-polygons-data-frame-consists-of-both-a-data-set-with" class="section level1">
<h1>A spatial polygons data frame consists of both a data set with</h1>
</div>
<div id="information-on-each-of-the-entities-in-this-case-electorates" class="section level1">
<h1>information on each of the entities (in this case, electorates),</h1>
</div>
<div id="and-a-set-of-polygons-for-each-electorate" class="section level1">
<h1>and a set of polygons for each electorate</h1>
</div>
<div id="sometimes-multiple-polygons-are-needed-e.g.-if-the-electorate-has-islands." class="section level1">
<h1>(sometimes multiple polygons are needed, e.g. if the electorate has islands).</h1>
</div>
<div id="we-want-to-extract-both-of-these-parts." class="section level1">
<h1>We want to extract both of these parts.</h1>
<p>nat_data &lt;- <a href="mailto:sF@data" class="email">sF@data</a>
head(nat_data)
# The row names of the data file are identifiers corresponding to the polygons
# - we want to make them a separate variable:
nat_data$id &lt;- row.names(nat_data)</p>
</div>
<div id="extracting-the-polygon-information" class="section level1">
<h1>Extracting the polygon information</h1>
</div>
<div id="the-fortify-function-in-the-ggplot2-package-extracts-the-polygons-into-a-data-frame." class="section level1">
<h1>The fortify function in the ggplot2 package extracts the polygons into a data frame.</h1>
<p>nat_map &lt;- ggplot2::fortify(sFsmall)
head(nat_map)
# We need to make sure that group and piece are kept as factor variables
# - if they are allowed to be converted to numeric values, it messes things up,
# because as factor levels 9 and 9.0 are distinct, whereas they are not when
# interpreted as numbers …
nat_map<span class="math inline">\(group &lt;- paste(&quot;g&quot;,nat_map\)</span>group,sep=“.”)
nat_map<span class="math inline">\(piece &lt;- paste(&quot;p&quot;,nat_map\)</span>piece,sep=“.”)
head(nat_map)</p>
<p>ggplot(nat_map, aes(x=long, y=lat, group=group)) +
geom_polygon(fill=“white”, colour=“black”)
ggplot(nat_data, aes(fill=AREA_SQKM)) +
geom_map(aes(map_id=id), map=nat_map) +
expand_limits(x=nat_map<span class="math inline">\(long, y=nat_map\)</span>lat) +
theme_map()</p>
</div>
<div id="missing-values--" class="section level1">
<h1>Missing values ————————————————-</h1>
<p>NA # a missing data piece
NaN # not a number
NULL # nothing at all, don’t exist
is.na()
is.nan()
na.omit()</p>
<p>library(naniar)
vis_miss(tao, sort_miss=TRUE) + theme(aspect.ratio=1)</p>
</div>
<div id="proportion-of-observations-missing" class="section level1">
<h1>Proportion of observations missing:</h1>
<p>s_miss &lt;- miss_summary(tao)
s_miss$miss_df_prop</p>
</div>
<div id="proportion-of-variables-missing" class="section level1">
<h1>Proportion of variables missing:</h1>
<p>s_miss$miss_var_prop</p>
</div>
<div id="how-many-observations-have-k-missings" class="section level1">
<h1>How many observations have <span class="math inline">\(k\)</span> missings?</h1>
<p>s_miss$miss_case_table</p>
</div>
<div id="by-group" class="section level1">
<h1>By group</h1>
<p>s_miss_group &lt;- tao %&gt;%
group_by(year) %&gt;% miss_summary()
s_miss_group$miss_case_table</p>
</div>
<div id="missings-shouldnt-be-ignored-but-most-software-will-simply-drop-them" class="section level1">
<h1>Missings shouldn’t be ignored but most software will simply drop them!</h1>
<p>ggplot(tao,
aes(x = sea.surface.temp,
y = humidity)) +
geom_point() + theme(aspect.ratio=1)
# Keep them in the plot
ggplot(tao,
aes(x = sea.surface.temp,
y = humidity)) +
scale_colour_brewer(palette=“Dark2”) +
geom_miss_point() + theme(aspect.ratio=1)
# by year
ggplot(tao,
aes(x = sea.surface.temp,
y = humidity)) +
geom_miss_point() +
scale_colour_brewer(palette=“Dark2”) +
facet_wrap(~year) +
theme(aspect.ratio=1)
# Understanding missing dependencies
ggplot(tao,
aes(x = sea.surface.temp,
y = air.temp)) +
geom_miss_point() +
scale_colour_brewer(palette=“Dark2”) +
facet_wrap(~year) +
theme(aspect.ratio=1)
# Year needs to be accounted for in finding good substu=itute values.
# Relationship with other variables
tao_shadow &lt;- bind_shadow(tao)
ggplot(data = tao_shadow,
aes(x = uwind, y=vwind, colour=air.temp_NA)) +
scale_colour_brewer(palette=“Dark2”) +
geom_point() + theme(aspect.ratio=1)</p>
</div>
<div id="common-ways-to-impute-values" class="section level1">
<h1>Common ways to impute values</h1>
</div>
<div id="simple-parametric-use-the-mean-or-median-of-the-complete-cases-for-each-variable" class="section level1">
<h1>- Simple parametric: use the mean or median of the complete cases for each variable</h1>
</div>
<div id="simple-non-parametric-find-the-k-nearest-neighbours-with-a-complete-value" class="section level1">
<h1>- Simple non-parametric: find the <span class="math inline">\(k\)</span> nearest neighbours with a complete value</h1>
</div>
<div id="and-average-these" class="section level1">
<h1>and average these</h1>
</div>
<div id="multiple-imputation-use-a-statistical-distribution" class="section level1">
<h1>- Multiple imputation: Use a statistical distribution,</h1>
</div>
<div id="e.g.-normal-model-and-simulate-a-value-or-set-of-values-hot-deck-imputation-for-the-missings" class="section level1">
<h1>e.g. normal model and simulate a value (or set of values, hot deck imputation) for the missings</h1>
</div>
<div id="examples---using-the-mean-and-ignoring-year." class="section level1">
<h1>Examples - using the mean and ignoring year.</h1>
<p>tao_shadow &lt;- tao_shadow %&gt;%
mutate(sea.surface.temp = ifelse(is.na(sea.surface.temp),
mean(sea.surface.temp, na.rm=TRUE),
sea.surface.temp),
air.temp = ifelse(is.na(air.temp),
mean(air.temp, na.rm=TRUE),
air.temp))
ggplot(tao_shadow,
aes(x = sea.surface.temp,
y = air.temp,
colour=air.temp_NA)) +
geom_point(alpha=0.7) +
facet_wrap(~year) +
scale_colour_brewer(palette=“Dark2”) +
theme(aspect.ratio=1)
# by year
t93 &lt;- bind_shadow(tao) %&gt;%
filter(year==“1993”) %&gt;%
mutate(sea.surface.temp = ifelse(is.na(sea.surface.temp),
mean(sea.surface.temp, na.rm=TRUE),
sea.surface.temp),
air.temp = ifelse(is.na(air.temp),
mean(air.temp, na.rm=TRUE),
air.temp))
t97 &lt;- bind_shadow(tao) %&gt;%
filter(year==“1997”) %&gt;%
mutate(sea.surface.temp = ifelse(is.na(sea.surface.temp),
mean(sea.surface.temp, na.rm=TRUE),
sea.surface.temp),
air.temp = ifelse(is.na(air.temp),
mean(air.temp, na.rm=TRUE),
air.temp))</p>
<p>tao_shadow &lt;- bind_rows(t93, t97)</p>
<p>ggplot(tao_shadow,
aes(x = sea.surface.temp,
y = air.temp,
colour=air.temp_NA)) +
geom_point(alpha=0.7) +
facet_wrap(~year) +
scale_colour_brewer(palette=“Dark2”) +
theme(aspect.ratio=1)
# Nearest neighbors imputation
#source(“<a href="https://bioconductor.org/biocLite.R" class="uri">https://bioconductor.org/biocLite.R</a>”)
#biocLite(“impute”)
library(impute)
tao_impute &lt;- bind_shadow(tao) %&gt;%
arrange(year, sea.surface.temp, air.temp) %&gt;%
select(sea.surface.temp, air.temp)
tao_impute &lt;- impute.knn(as.matrix(tao_impute), 5)
tao_shadow &lt;- bind_shadow(tao) %&gt;%
arrange(year, sea.surface.temp, air.temp) %&gt;%
mutate(sea.surface.temp = tao_impute<span class="math inline">\(data[,1],  air.temp = tao_impute\)</span>data[,2])
ggplot(tao_shadow,
aes(x = sea.surface.temp,
y = air.temp,
colour=air.temp_NA)) +
geom_point(alpha=0.7) +
facet_wrap(~year) +
scale_colour_brewer(palette=“Dark2”) +
theme(aspect.ratio=1)
# by year
tao_impute_93 &lt;- bind_shadow(tao) %&gt;%
arrange(year, sea.surface.temp, air.temp) %&gt;%
filter(year==“1993”) %&gt;%
select(sea.surface.temp, air.temp)
tao_impute_93 &lt;- impute.knn(as.matrix(tao_impute_93), 5)
tao_impute_97 &lt;- bind_shadow(tao) %&gt;%
arrange(year, sea.surface.temp, air.temp) %&gt;%
filter(year==“1997”) %&gt;%
select(sea.surface.temp, air.temp)
tao_impute_97 &lt;- impute.knn(as.matrix(tao_impute_97), 5)
tao_impute &lt;- rbind(tao_impute_93<span class="math inline">\(data, tao_impute_97\)</span>data)
tao_shadow &lt;- bind_shadow(tao) %&gt;%
arrange(year, sea.surface.temp, air.temp) %&gt;%
mutate(sea.surface.temp = tao_impute[,1],
air.temp = tao_impute[,2])
ggplot(tao_shadow,
aes(x = sea.surface.temp,
y = air.temp,
colour=air.temp_NA)) +
geom_point(alpha=0.5) +
facet_wrap(~year) +
scale_colour_brewer(palette=“Dark2”) +
theme(aspect.ratio=1)</p>
</div>
<div id="working-with-text--" class="section level1">
<h1>Working with text ——————————————————-</h1>
<p>tb &lt;- read_csv(“../data/tb.csv”)
tb[7:10,1:10]</p>
</div>
<div id="convert-to-long-form" class="section level1">
<h1>Convert to long form</h1>
<p>tb_long &lt;- tb %&gt;% gather(variable, count, m_04:f_u)
head(tb_long)</p>
</div>
<div id="string-split" class="section level1">
<h1>String split</h1>
<p>tb_long &lt;- tb_long %&gt;% separate(variable, c(“gender”, “age”))
head(tb_long)</p>
</div>
<div id="take-a-look" class="section level1">
<h1>Take a look</h1>
<p>tb_long %&gt;% filter(iso2 == “CO”, age!=“u”, year&gt;1998) %&gt;%
ggplot(aes(x=year, y=count, colour=gender)) +
geom_point() + facet_wrap(~age, ncol=3) +
scale_color_brewer(palette=“Dark2”)</p>
</div>
<div id="resourceson-regular-expressions-from-stat545-at-isu" class="section level1">
<h1>Resourceson regular expressions from stat545 at ISU</h1>
</div>
<div id="httpsstat585-at-isu.github.iomaterials07_regular-expressions01_regular_expressions.html" class="section level1">
<h1><a href="https://stat585-at-isu.github.io/materials/07_regular-expressions/01_regular_expressions.html" class="uri">https://stat585-at-isu.github.io/materials/07_regular-expressions/01_regular_expressions.html</a>)</h1>
</div>
<div id="web-scraping" class="section level1">
<h1>Web scraping ————————————————————</h1>
<p>library(ggthemes)
library(HLMdiag)
# - Example: NBA salaries
# - ESPN provides basketball players’ salaries for the 2017-2018 season
# at <a href="http://espn.go.com/nba/salaries">http://espn.go.com/nba/salaries</a>
library(XML)
nba &lt;- NULL
for (i in 1:11) {
temp &lt;- readHTMLTable(
sprintf(“<a href="http://espn.go.com/nba/salaries/_/page/%d" class="uri">http://espn.go.com/nba/salaries/_/page/%d</a>”,i))[[1]]
nba &lt;- rbind(nba, temp)
}
glimpse(nba)</p>
</div>
<div id="text-massaging" class="section level1">
<h1>Text massaging</h1>
<p>head(nba$SALARY)</p>
</div>
<div id="get-rid-of-and-in-salaries-and-convert-to-numeric" class="section level1">
<h1>get rid of $ and , in salaries and convert to numeric:</h1>
<p>gsub(“[$,]”, "“, head(as.character(nba<span class="math inline">\(SALARY))) nba\)</span>SALARY &lt;- as.numeric(gsub(”[$,]“,”",
as.character(nba<span class="math inline">\(SALARY))) head(nba\)</span>SALARY)</p>
</div>
<div id="cleaning-nba-salaries-data-hunting-the-warning" class="section level1">
<h1>Cleaning NBA salaries data: hunting the warning</h1>
<p>nba %&gt;% filter(is.na(SALARY)) %&gt;% head()
# - We don’t need these rows - delete all of them</p>
<p>dim(nba)
nba &lt;- nba[-which(nba$RK==“RK”),]
dim(nba)</p>
</div>
<div id="cleaning-nba-data" class="section level1">
<h1>Cleaning NBA data</h1>
</div>
<div id="separate-names-into-first-last-and-position" class="section level1">
<h1>- Separate names into first, last, and position</h1>
<p>nba &lt;- nba %&gt;%
mutate(NAME = as.character(nba$NAME)) %&gt;%
separate(NAME, c(“full_name”, “position”), “,”) %&gt;%
separate(full_name, c(“first”, “last”), " ")
head(nba)
# Cleaned data …?
# - Numbers might still be wrong, but now we are in a position to check for that.
ggplot(data=nba, aes(x=SALARY)) + geom_histogram()</p>
</div>
<div id="web-scraping-resources" class="section level1">
<h1>Web scraping resources</h1>
</div>
<div id="carson-sieverts-tutorial" class="section level1">
<h1>- Carson Sievert’s <a href="https://slides.cpsievert.me/web-scraping/20150612/">tutorial</a></h1>
</div>
<div id="ankit-agarwals-blog" class="section level1">
<h1>- Ankit Agarwal’s blog</h1>
</div>
<div id="httpbrazenly.blogspot.com.au201605r-consummate-all-encompassing-tool-for.html" class="section level1">
<h1>(<a href="http://brazenly.blogspot.com.au/2016/05/r-consummate-all-encompassing-tool-for.html" class="uri">http://brazenly.blogspot.com.au/2016/05/r-consummate-all-encompassing-tool-for.html</a>);</h1>
</div>
<div id="look-for-several-more-advanced-scraping" class="section level1">
<h1>Look for several more advanced scraping</h1>
</div>
<div id="r-bloggers-post" class="section level1">
<h1>- R Blogger’s <a href="https://www.r-bloggers.com/scraping-with-selenium/">post</a></h1>
<p>library(rvest)
tem &lt;- list()
for(i in 2011:2017){
tem[[i-2010]] &lt;- read_html(paste0(“<a href="https://www.wunderground.com/history/airport/YMML/" class="uri">https://www.wunderground.com/history/airport/YMML/</a>”,
i,
“/5/4/MonthlyHistory.html?req_city=&amp;req_state=
&amp;req_statename=&amp;reqdb.zip=&amp;reqdb.magic=&amp;reqdb.wmo=”)) %&gt;%
html_node(“#obsTable”) %&gt;% html_table()</p>
<p>}</p>
<p>read_html(“<a href="https://robjhyndman.com/hyndsight/show-me-the-evidence/" class="uri">https://robjhyndman.com/hyndsight/show-me-the-evidence/</a>”) %&gt;%
html_node(“table”) %&gt;% html_table() %&gt;% kable()
read_html(“<a href="https://robjhyndman.com/hyndsight/show-me-the-evidence/" class="uri">https://robjhyndman.com/hyndsight/show-me-the-evidence/</a>”) %&gt;%
html_node(“table:nth-child(8)”) %&gt;% html_table() %&gt;% kable()</p>
</div>
<div id="character-manipulation-regular-expression" class="section level1">
<h1>Character manipulation / Regular expression ————————————————–</h1>
<p>?regex
??<code>regular expression</code>
strsplit(c(“lawrence”, “beautiful”),“e”)
tolower() # convert strins to lower case latters
cat() #Concatenate and Print
gsub(pattern, replacement, x) # pattern matching and replacement</p>
</div>
<div id="grepl" class="section level1">
<h1>grepl</h1>
</div>
<div id="logical-output" class="section level1">
<h1>logical output</h1>
<p>grepl(patter = <regex>, x = <string>)
animals &lt;- c(“cat”, “moose”, “impala”, “ant”, “kiwi”)
grepl(pattern = “a”, x = animals)
grepl(pattern = “^a”, x = animals) # beginning with an “a”
grepl(pattern = “a$”, x = animals) # end with an “a”</p>
</div>
<div id="grep" class="section level1">
<h1>grep</h1>
</div>
<div id="indice-output" class="section level1">
<h1>indice output</h1>
<p>which(grepl(pattern = “a”, x = animals) )
animals &lt;- c(“cat”, “moose”, “impala”, “ant”, “kiwi”)
grep(pattern = “a”, x = animals)
grep(pattern = “^a”, x = animals) # beginning with an “a”
grep(pattern = “a$”, x = animals) # end with an “a”</p>
<p>emails &lt;- c(“<a href="mailto:john.doe@ivyleague.edu" class="email">john.doe@ivyleague.edu</a>”, “<a href="mailto:education@world.gov" class="email">education@world.gov</a>”, “<a href="mailto:dalai.lama@peace.org" class="email">dalai.lama@peace.org</a>”,
“invalid.edu”, “<a href="mailto:quant@bigdatacollege.edu" class="email">quant@bigdatacollege.edu</a>”, “<a href="mailto:cookie.monster@sesame.tv" class="email">cookie.monster@sesame.tv</a>”)
grepl("@.<em>\.edu$", emails) #any character (.) zero or more times (</em>). The \ part escapes the dot</p>
</div>
<div id="sub-gsub" class="section level1">
<h1>sub, gsub</h1>
<p>sub(pattern = <regex>, replacement = <str>, x = <str>)
animals &lt;- c(“cat”, “moose”, “impala”, “ant”, “kiwi”)
sub(pattern = “a”, replacement = “o”, x = animals) # replace first match
gsub(pattern = “a”, replacement = “o”, x = animals) # replace all matches
gsub(pattern = “a|i”, replacement = "_", x = animals)</p>
<p>awards &lt;- c(“Won 1 Oscar.”,
“Won 1 Oscar. Another 9 wins &amp; 24 nominations.”,
“1 win and 2 nominations.”,
“2 wins &amp; 3 nominations.”,
“Nominated for 2 Golden Globes. 1 more win &amp; 2 nominations.”,
“4 wins &amp; 1 nomination.”)</p>
<p>sub(“.<em>\s([0-9]+)\snomination.</em>$”, “\1”, awards)
# .*: A usual suspect! It can be read as “any character that is matched zero or more times”.
# \s: Match a space. The “s” is normally a character, escaping it (\) makes it a metacharacter.
# [0-9]+: Match the numbers 0 to 9, at least once (+).
# ([0-9]+): The parentheses are used to make parts of the matching string available to define
# the replacement.
# The \1 in the replacement argument of sub() gets set to the string that is captured
# by the regular expression [0-9]+.</p>
</div>
<div id="grammar-of-graphics-and-statistics" class="section level1">
<h1>Grammar of graphics and statistics ————————————–</h1>
</div>
<div id="pipeline-messy-to-tidy-to-plot" class="section level1">
<h1>Pipeline: Messy to tidy to plot</h1>
<p>messy_data &lt;- read_csv(“../data/tb.csv”)
head(messy_data)
tidy_data &lt;- messy_data %&gt;%
gather(demo, count, -year, -iso2, na.rm = TRUE) %&gt;%
separate(demo, c(“gender”, “age”))
tidy_data &lt;- tidy_data %&gt;%
filter(!(age %in% c(“014”, “04”, “514”, “u”)))
head(tidy_data)
# 100% charts
tidy_data %&gt;%
filter(iso2 == “AU”) %&gt;%
ggplot(aes(x = year, y = count, fill = gender)) +
geom_bar(stat = “identity”, position = “fill”) +
facet_grid(~ age) +
scale_fill_brewer(palette=“Dark2”)
# Stacked barcharts
tidy_data %&gt;%
filter(iso2 == “AU”) %&gt;%
ggplot(aes(x = year, y = count, fill = gender)) +
geom_bar(stat = “identity”) +
facet_grid(~ age) +
scale_fill_brewer(palette=“Dark2”) +
theme(
axis.text = element_text(size = 14),
strip.text = element_text(size = 16),
axis.title = element_text(size = 16))
# Side-by-side barcharts
tidy_data %&gt;%
filter(iso2 == “AU”) %&gt;%
ggplot(aes(x = year, y = count, fill = gender)) +
geom_bar(stat = “identity”, position=“dodge”) +
facet_grid(~ age) +
scale_fill_brewer(palette=“Dark2”) +
theme(
axis.text = element_text(size = 14),
strip.text = element_text(size = 16),
axis.title = element_text(size = 16)
)
# facet by gender
tidy_data %&gt;%
filter(iso2 == “AU”) %&gt;%
ggplot(aes(x = year, y = count, fill = gender)) +
geom_bar(stat = “identity”) +
facet_grid(gender ~ age) +
scale_fill_brewer(palette=“Dark2”) +
theme(
axis.text = element_text(size = 14),
strip.text = element_text(size = 16),
axis.title = element_text(size = 16)
)
# Rose plot
tidy_data %&gt;%
filter(iso2 == “AU”) %&gt;%
ggplot(aes(x = year, y = count, fill = gender)) +
geom_bar(stat = “identity”) +
facet_grid(gender ~ age) +
scale_fill_brewer(palette=“Dark2”) +
theme(
axis.text = element_blank(),
strip.text = element_text(size = 16),
axis.title = element_text(size = 16)
) + coord_polar()
# Rainbow charts
tidy_data %&gt;%
filter(iso2 == “AU”) %&gt;%
ggplot(aes(x = 1, y = count, fill = factor(year))) +
geom_bar(stat = “identity”, position=“fill”) +
facet_grid(gender ~ age) +
theme(
axis.text = element_blank(),
strip.text = element_text(size = 16),
axis.title = element_text(size = 16)
)
# Pie charts
tidy_data %&gt;%
filter(iso2 == “AU”) %&gt;%
ggplot(aes(x = 1, y = count, fill = factor(year))) +
geom_bar(stat = “identity”, position=“fill”) +
facet_grid(gender ~ age) +
theme(
axis.text = element_blank(),
strip.text = element_text(size = 16),
axis.title = element_text(size = 16)
) + coord_polar(theta=“y”)</p>
</div>
<div id="summary-of-grammar" class="section level1">
<h1>Summary of grammar</h1>
</div>
<div id="the-grammar-is-a-functional-language-for-decribing-the-mapping-of-random" class="section level1">
<h1>- The grammar is a functional language for decribing the mapping of (random)</h1>
</div>
<div id="variables-to-plot-elements." class="section level1">
<h1>variables to plot elements.</h1>
</div>
<div id="original-resource-lee-wilkinson" class="section level1">
<h1>- Original resource: Lee Wilkinson</h1>
</div>
<div id="grammar-of-graphics" class="section level1">
<h1><a href="https://www.cs.uic.edu/~wilkinson/TheGrammarOfGraphics/GOG.html">Grammar of graphics</a></h1>
</div>
<div id="inference" class="section level1">
<h1>Inference</h1>
</div>
<div id="choice-of-plot-implicitly-sets-h_0-h_1" class="section level1">
<h1>- Choice of plot implicitly sets <span class="math inline">\(H_0\)</span>, <span class="math inline">\(H_1\)</span></h1>
</div>
<div id="generically-we-are-thinking-h_0-no-pattern-h_1-pattern" class="section level1">
<h1>- Generically, we are thinking <span class="math inline">\(H_0\)</span>: no pattern, <span class="math inline">\(H_1\)</span>: pattern,</h1>
</div>
<div id="but-the-choice-of-plot-makes-this-much-more-explicit" class="section level1">
<h1>but the choice of plot makes this much more explicit</h1>
</div>
<div id="putting-the-pieces-together" class="section level1">
<h1>Putting the pieces together</h1>
<p>df &lt;- data.frame(v1=c(rexp(20), rexp(15, 2)),
v2=c(rep(“A”, 20), rep(“B”, 15)))
ggplot(df, aes(x=v2, y=v1, fill=v2)) +
geom_boxplot() + coord_flip()
# - Question? Is there a difference between the two groups?
# <span class="math inline">\(H_0\)</span>: no difference, <span class="math inline">\(H_1\)</span>: difference
# - Data, variables: Two variables: v1, v2; v2 is categorical
# - Mapping: x=V2, y=V1, colour=V1, geom=boxplot
# - Null generating mechanism: permute the values of V1, relative to V2</p>
</div>
<div id="principles-of-design--" class="section level1">
<h1>Principles of design —————————————————-</h1>
</div>
<div id="hierarchy-of-mappings-first-position-along-an-axis" class="section level1">
<h1>- Hierarchy of mappings: (first) position along an axis</h1>
</div>
<div id="last-color-cleveland-1984-heer-and-bostock-2009" class="section level1">
<h1>- (last) color (Cleveland, 1984; Heer and Bostock, 2009)</h1>
</div>
<div id="pre-attentive-some-elements-are-noticed-before-you-even-realise-it." class="section level1">
<h1>- Pre-attentive: Some elements are noticed before you even realise it.</h1>
</div>
<div id="color-pre-attentive-palettes---qualitative-sequential-diverging." class="section level1">
<h1>- Color: (pre-attentive) palettes - qualitative, sequential, diverging.</h1>
</div>
<div id="proximity-place-elements-for-primary-comparison-close-together." class="section level1">
<h1>- Proximity: Place elements for primary comparison close together.</h1>
</div>
<div id="change-blindness-when-focus-is-interrupted-differences-may-not-be-noticed." class="section level1">
<h1>- Change blindness: When focus is interrupted differences may not be noticed.</h1>
</div>
<div id="hierarchy-of-mappings" class="section level1">
<h1>Hierarchy of mappings</h1>
</div>
<div id="position---common-scale-best" class="section level1">
<h1>- 1.Position - common scale (BEST)</h1>
</div>
<div id="position---nonaligned-scale" class="section level1">
<h1>- 2.Position - nonaligned scale</h1>
</div>
<div id="length-direction-angle" class="section level1">
<h1>- 3.Length, direction, angle</h1>
</div>
<div id="area" class="section level1">
<h1>- 4.Area</h1>
</div>
<div id="volume-curvature" class="section level1">
<h1>- 5.Volume, curvature</h1>
</div>
<div id="shading-color-worst" class="section level1">
<h1>- 6.Shading, color (WORST)</h1>
</div>
<div id="pre-attentive" class="section level1">
<h1>Pre-attentive</h1>
<p>df &lt;- data.frame(x=runif(100), y=runif(100), cl=sample(c(rep(“A”, 1), rep(“B”, 99))))
ggplot(data=df, aes(x, y, shape=cl)) + theme_bw() +
geom_point() +
theme(legend.position=“None”, aspect.ratio=1)</p>
<p>ggplot(data=df, aes(x, y, colour=cl)) +
geom_point() +
scale_colour_brewer(palette=“Dark2”) +
theme_bw() +
theme(legend.position=“None”, aspect.ratio=1)</p>
</div>
<div id="color-palettes" class="section level1">
<h1>Color palettes</h1>
</div>
<div id="qualitative-categorical-variables" class="section level1">
<h1>- Qualitative: categorical variables</h1>
</div>
<div id="map-categorical-variables-with-small-number-of-categories" class="section level1">
<h1>- Map categorical variables, with small number of categories</h1>
</div>
<div id="sequential-low-to-high-numeric-values" class="section level1">
<h1>- Sequential: low to high numeric values</h1>
</div>
<div id="numerical-variables-emphasis-is-on-the-high-values" class="section level1">
<h1>- Numerical variables, emphasis is on the high values</h1>
</div>
<div id="diverging-negative-to-positive-values" class="section level1">
<h1>- Diverging: negative to positive values</h1>
</div>
<div id="numerical-variables-emphasis-is-on-both-top-and-bottom-values." class="section level1">
<h1>- Numerical variables, emphasis is on both top and bottom values.</h1>
</div>
<div id="only-makes-sense-if-you-have-positive-and-negative-values." class="section level1">
<h1>Only makes sense if you have positive and negative values.</h1>
<p>library(RColorBrewer)
display.brewer.all()</p>
</div>
<div id="proximity" class="section level1">
<h1>Proximity</h1>
<p>ggplot(fly_sub, aes(x=<code>In general, is itrude to bring a baby on a plane?</code>,
fill=Gender)) +
scale_fill_brewer(palette=“Dark2”) +
geom_bar(position=“fill”) + coord_flip() + facet_wrap(~Age, ncol=5)
# With this arrangement we can see proportion of gender across rudeness category,
# within age groups.
ggplot(fly_sub, aes(x=Gender,
fill=<code>In general, is itrude to bring a baby on a plane?</code>)) +
geom_bar(position=“fill”) + coord_flip() + facet_wrap(~Age, ncol=5) +
scale_fill_brewer(palette=“Dark2”) +
theme(legend.position=“bottom”)
# Now we can see proportion of rudeness category across gender, within age groups.
ggplot(fly_sub, aes(x=Age,
fill=<code>In general, is itrude to bring a baby on a plane?</code>)) +
geom_bar(position=“fill”) + coord_flip() + facet_wrap(~Gender, ncol=5) +
scale_fill_brewer(palette=“Dark2”) +
theme(legend.position=“bottom”)
# And, now we can see proportion of rudeness category across age groups, within gender.</p>
</div>
<div id="short-cut" class="section level1">
<h1>short-cut —————————————————————</h1>
</div>
<div id="reload-packages" class="section level1">
<h1>reload packages</h1>
<p>Ctrl + Shift + L</p>
</div>
<div id="generate-documents" class="section level1">
<h1>generate documents</h1>
<p>Ctrl/Cmd + Shift + D</p>
</div>
<div id="to-show-links-in-docs-build" class="section level1">
<h1>(to show links in docs) build</h1>
<p>Ctrl/Cmd + Shift + B</p>
</div>
<div id="knitr" class="section level1">
<h1>knitr</h1>
<p>Ctrl/Cmd + Shift + K</p>
</div>
<div id="run-code-in-a-chunk" class="section level1">
<h1>run code in a chunk</h1>
<p>Ctrl + Alt + C</p>
</div>
<div id="re-run-the-entire-document-in-a-fresh-r-session-using-knit" class="section level1">
<h1>Re-run the entire document in a fresh R session using Knit</h1>
<p>Ctrl/Cmd + Shift + K</p>
</div>
<div id="test" class="section level1">
<h1>test</h1>
<p>Ctrl/Cmd + Shift + T</p>
</div>
<div id="package" class="section level1">
<h1>Package —————————————————————–</h1>
<p>search() # load package = attach to search list
library()
require() # return FALSE insteal of error in library</p>
</div>
<div id="create-packages" class="section level1">
<h1>create packages</h1>
<p>devtools::create(“path/to/package/pkgname”)</p>
<p>#add package in DESCRITION
devtools::use_package(“dplyr”, “Suggests”)</p>
</div>
<div id="roxygen-comments" class="section level1">
<h1>roxygen comments</h1>
<p>#’ Add together two numbers.
#’
#’ <span class="citation">@param</span> x A number.
#’ <span class="citation">@param</span> y A number.
#’ <span class="citation">@return</span> The sum of  and .
#’ <span class="citation">@examples</span>
#’ add(1, 1)
#’ add(10, 1)
add &lt;- function(x, y) {
x + y
}</p>
<p>#’ foo: A package for computating the notorious bar statistic.
#’
#’ The foo package provides three categories of important functions:
#’ foo, bar and baz.
#’
#’ <span class="citation">@section</span> Foo functions:
#’ The foo functions …
#’
#’ <span class="citation">@docType</span> package
#’ <span class="citation">@name</span> foo
NULL</p>
<p>#’ <span class="citation">@aliases</span> alias1 alias2
#’ <span class="citation">@keywords</span> keyword1 keyword2
#’ adds standardised keywords. Keywords are optional,
#’ but if present, must be taken from a predefined list found in
#’ file.path(R.home(“doc”), “KEYWORDS”).
#’</p>
<p>#’ Prices of 50,000 round cut diamonds.
#’
#’ A dataset containing the prices and other attributes of almost 54,000
#’ diamonds.
#’
#’ <span class="citation">@format</span> A data frame with 53940 rows and 10 variables:
#’ 
#’ <span class="citation">@source</span> 
“diamonds”</p>
</div>
<div id="generate-documents-1" class="section level1">
<h1>generate documents</h1>
<p>devtools::document()
Ctrl/Cmd + Shift + D</p>
</div>
<div id="to-show-links-in-docs-build-1" class="section level1">
<h1>(to show links in docs) build</h1>
<p>Ctrl/Cmd + Shift + B</p>
</div>
<div id="create-vignette" class="section level1">
<h1>create vignette</h1>
<p>devtools::use_vignette(“my-vignette”)</p>
</div>
<div id="view-vignette" class="section level1">
<h1>view vignette</h1>
<p>browseVignettes(“packagename”)</p>
</div>
<div id="build-all-vignettes-from-the-console-rarely-useful" class="section level1">
<h1>build all vignettes from the console (rarely useful)</h1>
<p>devtools::build_vignettes()
# Instead create a package bundle with the vignettes included
devtools::build()</p>
</div>
<div id="namespace" class="section level1">
<h1>namespace</h1>
</div>
<div id="load-but-not-attach" class="section level1">
<h1>load but not attach</h1>
<p>requireNamespace() # FALSE
loadNamespace() # error</p>
</div>
<div id="ascii-characters" class="section level1">
<h1>ASCII characters</h1>
<p>x &lt;- "This is a bullet</p>
</div>
